@model List<Gymify.Application.DTOs.Exercise.AdminExerciseDto>
@using Gymify.Data.Enums

@{
    ViewData["Title"] = "Exercise Moderation";
}

<div class="ae-page-container">
    <h2 class="ae-page-title mb-4">Pending Exercises</h2>

    @if (!Model.Any())
    {
        <div class="friends-empty">
            <i class="fa-solid fa-dumbbell" style="color: #ccc;"></i>
            <p>No exercises waiting for approval.</p>
        </div>
    }
    else
    {
        <div class="d-flex flex-column gap-4">
            @foreach (var ex in Model)
            {
                <div class="ae-manager-card p-4">
                    
                    <form id="approve-form-@ex.Id" method="post" action="/admin/exercises/approve">
                        <input type="hidden" name="Id" value="@ex.Id" />

                        <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
                            <h3 class="ae-item-title" style="font-size: 1.25rem; font-weight: 800;">
                                @(string.IsNullOrEmpty(ex.NameEn) ? ex.NameUk : ex.NameEn)
                            </h3>
                            <span class="ae-badge" style="background: var(--gym-orange); color: #fff;">ID: @ex.Id</span>
                        </div>

                        <div class="row g-3">
                            
                            <div class="col-md-6">
                                <label class="ae-label-mini">Name (Ukrainian)</label>
                                <input name="NameUk" value="@ex.NameUk" class="ae-input-std" placeholder="Назва українською..." />
                            </div>
                            <div class="col-md-6">
                                <label class="ae-label-mini">Name (English)</label>
                                <input name="NameEn" value="@ex.NameEn" class="ae-input-std" placeholder="English name..." />
                            </div>

                            <div class="col-12">
                                <label class="ae-label-mini">Description (Ukrainian)</label>
                                <textarea name="DescriptionUk" class="ae-input-std" rows="3" placeholder="Опис українською...">@ex.DescriptionUk</textarea>
                            </div>
                            <div class="col-12">
                                <label class="ae-label-mini">Description (English)</label>
                                <textarea name="DescriptionEn" class="ae-input-std" rows="3" placeholder="English description...">@ex.DescriptionEn</textarea>
                            </div>

                            <div class="col-md-3">
                                <label class="ae-label-mini">Type</label>
                                <select name="Type" class="ae-input-std">
                                    @foreach (var t in Enum.GetValues(typeof(ExerciseType)))
                                    {
                                        <option value="@t" selected="@(t.Equals(ex.Type))">@t</option>
                                    }
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="ae-label-mini">Base XP</label>
                                <input name="BaseXP" type="number" min="0" value="@ex.BaseXP" class="ae-input-std" />
                            </div>
                            <div class="col-md-2">
                                <label class="ae-label-mini">Diff. Mult</label>
                                <input name="DifficultyMultiplier" type="number" step="0.1" min="0" value="@ex.DifficultyMultiplier" class="ae-input-std" />
                            </div>
                             <div class="col-md-5">
                                <label class="ae-label-mini">Video URL</label>
                                <input name="VideoURL" value="@ex.VideoURL" class="ae-input-std" placeholder="https://..." />
                            </div>
                        </div>
                    </form>

                    <div class="d-flex justify-content-between align-items-end mt-4 pt-3 border-top gap-3">
                        
                        <form method="post" action="/admin/exercises/reject" class="flex-grow-1" style="max-width: 500px;">
                            <input type="hidden" name="id" value="@ex.Id" />
                            <div class="input-group">
                                <input type="text" name="reason" placeholder="Reason for rejection..." class="ae-input-std" style="border-top-right-radius: 0; border-bottom-right-radius: 0;" required />
                                <button type="submit" class="gym-btn gym-btn-danger" style="border-top-left-radius: 0; border-bottom-left-radius: 0;">
                                    Reject
                                </button>
                            </div>
                        </form>

                        <button type="submit" form="approve-form-@ex.Id" class="gym-btn gym-btn-primary px-4">
                            Approve & Save
                        </button>

                    </div>
                </div>
            }
        </div>
    }
</div>