@model Gymify.Application.DTOs.Image.ImageUploadModel

<div class="image-upload-component mb-3">
    <form id="imageUploadForm" asp-controller="Image" asp-action="UploadFromComponent"
          enctype="multipart/form-data" method="post">
        <input type="file" class="form-control" id="imageFile" name="file" accept=".png,.jpg,.jpeg" />

        <div class="mt-2">
            <button type="submit" class="btn btn-primary">Upload</button>
        </div>
    </form>

    <div id="uploadStatus" class="mt-2 text-success d-none"></div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const fileInput = document.getElementById("imageFile");
        const form = document.getElementById("imageUploadForm");
        const statusDiv = document.getElementById("uploadStatus");

        fileInput.addEventListener("change", () => {
            const file = fileInput.files[0];
            if (!file) return;

            const formData = new FormData(form);
            formData.append("fileName", file.name.split(".")[0]);
            formData.append("title", file.name.split(".")[0]);

            form.onsubmit = async (e) => {
                e.preventDefault();

                statusDiv.classList.remove("d-none");
                statusDiv.textContent = "Uploading...";

                const response = await fetch(form.action, {
                    method: "POST",
                    body: formData
                });

                if (response.ok) {
                    statusDiv.textContent = "✅ Image uploaded successfully!";
                    const result = await response.json();
                    console.log("Image URL:", result.url);
                } else {
                    statusDiv.textContent = "❌ Upload failed.";
                }
            };
        });
    });
</script>

<style>
    .image-upload-component input[type="file"] {
        background-color: #eae7dc;
        border: 1px solid #d8c3a5;
        padding: 6px;
    }

    .btn-primary {
        background-color: #d8c3a5;
        border-color: #d8c3a5;
    }

    .btn-primary:hover {
        background-color: #c4a889;
    }
</style>
